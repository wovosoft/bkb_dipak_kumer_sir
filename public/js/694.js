(self.webpackChunk=self.webpackChunk||[]).push([[694],{822:(t,e,n)=>{"use strict";n.d(e,{Z:()=>o});var r=n(3645),a=n.n(r)()((function(t){return t[1]}));a.push([t.id,"#loan-types-accordion .not-collapsed{background-color:#000;color:#fff}",""]);const o=a},5694:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>l});var r=n(8845),a=n(4719);const o={components:{TheTable:r.Z},mixins:[a.ZP],computed:{baseUrl:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(){return baseUrl()}))},data:function(){return{currentItem:null,currentSubtype:null,currentDocument:null,form_sub_type:{title:null},document_type_form:{title:null,is_mandatory:!1},fields:[{key:"id",sortable:!0},{key:"title",sortable:!0},{key:"action",thClass:"text-right",tdClass:"text-right"}]}},methods:{o2t:a.EI,initAddForm:function(){this.$set(this,"currentItem",{name:null,address:null}),this.$bvModal.show("edit_modal")},handleSubmit:function(){var t=this;axios.post(this.baseUrl+"/backend/loan_types/store",JSON.parse(JSON.stringify(this.currentItem))).then((function(e){var n=e.data;console.log(n),t.$bvToast.toast(n.message,{title:n.title,autoHideDelay:3e3,appendToast:!0,variant:n.variant||"success"}),t.$refs.datatable.refresh(),t.$bvModal.hide("edit_modal")})).catch((function(e){var n=e.response;console.log(n.data),t.$bvToast.toast(n.data.message,{title:"Server Error",variant:"danger",autoHideDelay:3e3,appendToast:!0})}))},getCrmRmOffices:function(t){var e=this;axios.post(this.baseUrl+"/backend/crm_rm_offices/list",{divisional_office_id:t.id}).then((function(t){var n=t.data;e.crm_rm_offices=n})).catch((function(t){var n=t.response;e.crm_rm_offices=[],console.log(n.data)}))},handleSubTypeSubmit:function(){var t=this,e=JSON.parse(JSON.stringify(this.currentSubtype)).id;axios.post(baseUrl()+"/backend/loan_sub_types/store",Object.assign({},JSON.parse(JSON.stringify(this.currentSubtype)),{loan_type_id:this.currentItem.id})).then((function(n){console.log(n.data),e||t.currentItem.sub_types.push(n.data.item),t.currentSubtype={},t.$root.msgBox(n.data)})).catch((function(e){t.$root.msgBox(e.response.data),console.log(e.response.data)}))},handleDocumentTypeSubmit:function(){var t=this,e=JSON.parse(JSON.stringify(this.currentDocument)).id;axios.post(baseUrl()+"/backend/document_types/store",Object.assign({},JSON.parse(JSON.stringify(this.currentSubtype)),{loan_type_id:this.currentSubtype.id})).then((function(n){console.log(n.data),e||t.currentSubtype.document_types.push(n.data.item),t.currentSubtype={},t.$root.msgBox(n.data)})).catch((function(e){t.$root.msgBox(e.response.data),console.log(e.response.data)}))}}};var i=n(3379),s=n.n(i),u=n(822),c={insert:"head",singleton:!1};s()(u.Z,c);u.Z.locals;const l=(0,n(1900).Z)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("the-table",{attrs:{datatable:t.datatable,fields:t.fields},scopedSlots:t._u([{key:"header_buttons",fn:function(){return[n("b-button-group",{attrs:{size:"sm"}},[n("b-button",{attrs:{variant:"dark"},on:{click:t.initAddForm}},[n("b-icon-plus")],1)],1)]},proxy:!0}])},[t._v(" "),n("b-table",t._b({ref:"datatable",attrs:{"no-provider-filtering":!1,"api-url":t.baseUrl+"/backend/loan_types"},scopedSlots:t._u([{key:"cell(action)",fn:function(e){return[n("b-button-group",{attrs:{size:"sm"}},[n("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal:loan_type_details",arg:"loan_type_details"}],attrs:{variant:"dark",title:"Loan Types"},on:{click:function(n){t.currentItem=JSON.parse(JSON.stringify(e.item))}}},[n("b-icon-eye")],1),t._v(" "),n("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal:edit_modal",arg:"edit_modal"}],attrs:{variant:"warning",title:"Edit"},on:{click:function(n){t.currentItem=JSON.parse(JSON.stringify(e.item))}}},[n("b-icon-pencil-square")],1),t._v(" "),n("b-button",{attrs:{variant:"danger",title:"Delete"}},[n("b-icon-trash")],1)],1)]}}])},"b-table",Object.assign({},t.attrs),!1))],1),t._v(" "),n("b-modal",t._b({attrs:{lazy:"",id:"edit_modal"},on:{hidden:function(e){t.currentItem=null}}},"b-modal",{size:"md",bodyClass:"p-2",headerBgVariant:"dark",headerTextVariant:"light",title:"Add/Edit Loan Type",hideFooter:!0},!1),[t.currentItem?n("b-form",{on:{submit:function(e){return e.preventDefault(),t.handleSubmit(e)}}},[n("b-form-group",{attrs:{label:"Title"}},[n("b-input",{attrs:{required:!0,placeholder:"Name"},model:{value:t.currentItem.title,callback:function(e){t.$set(t.currentItem,"title",e)},expression:"currentItem.title"}})],1),t._v(" "),n("b-button",{attrs:{type:"submit",variant:"dark",block:""}},[t._v("SUBMIT")])],1):t._e()],1),t._v(" "),n("b-modal",{attrs:{id:"loan_type_details",title:(t.currentItem?t.currentItem.title:"Loan Type")+" Details",right:"",size:"xl",scrollable:"","header-bg-variant":"dark","header-text-variant":"light",backdrop:""},on:{hidden:function(){t.currentItem=null,t.currentSubtype=null,t.currentDocument=null}}},[n("b-row",[n("b-col",{attrs:{md:"4",sm:"12"}},[t.currentItem?n("div",{staticClass:"accordion",attrs:{id:"loan-types-accordion",role:"tablist"}},t._l(t.currentItem.sub_types,(function(e,r){return n("b-card",{key:r,staticClass:"m-0",attrs:{"no-body":""}},[n("b-input-group",{scopedSlots:t._u([{key:"append",fn:function(){return[n("b-button",{on:{click:function(n){t.currentSubtype=e}}},[n("b-icon-pencil-square")],1),t._v(" "),n("b-button",{attrs:{variant:"primary"},on:{click:function(n){t.currentDocument={loan_type_id:t.currentItem.id,loan_sub_type_id:e.id,is_new:!0}}}},[t._v("\n                  New\n                ")])]},proxy:!0}],null,!0)},[n("div",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"accordion-"+r,expression:"'accordion-' + subtype_key"}],staticClass:"form-control"},[t._v("\n                "+t._s([e.id,e.title].join(" # "))+"\n              ")])]),t._v(" "),n("b-collapse",{attrs:{id:"accordion-"+r,accordion:"my-accordion",role:"tabpanel"}},[n("b-list-group",[t._l(e.document_types,(function(e,r){return[e?n("b-list-group-item",{key:r,staticStyle:{cursor:"pointer"},attrs:{active:t.currentDocument&&t.currentDocument.id===e.id},on:{click:function(){t.currentDocument=Object.assign({},Object.assign({},e),{is_mandatory:!!e.is_mandatory})}}},[t._v("\n                    "+t._s([e.id,e.title].join(" # "))+"\n                    "+t._s(e.is_mandatory?"*":null)+"\n                  ")]):t._e()]}))],2)],1)],1)})),1):t._e()]),t._v(" "),n("b-col",{attrs:{md:"8",sm:"12"}},[n("b-button-group",[n("b-button",{attrs:{variant:"dark"},on:{click:function(e){t.currentSubtype={loan_type_id:t.currentItem.id,is_new:!0}}}},[t._v("\n            New Sub Type\n          ")])],1),t._v(" "),t.currentSubtype&&(t.currentSubtype.id||t.currentSubtype.is_new)?n("b-form",{on:{submit:function(e){return e.preventDefault(),t.handleSubTypeSubmit(e)}}},[n("h3",[t._v("\n            Current Sub Type |\n            "+t._s([t.currentSubtype.id,t.currentSubtype.title].join(" # "))+"\n          ")]),t._v(" "),n("b-form-group",{attrs:{label:"Title"}},[n("b-input",{attrs:{required:"",placeholder:"Loan Sub Type Title"},model:{value:t.currentSubtype.title,callback:function(e){t.$set(t.currentSubtype,"title",e)},expression:"currentSubtype.title"}})],1),t._v(" "),n("b-button",{attrs:{type:"submit",block:"",variant:"dark"}},[t._v("SUBMIT")])],1):t._e(),t._v(" "),t.currentSubtype&&t.currentDocument?n("hr"):t._e(),t._v(" "),t.currentDocument&&(t.currentDocument.id||t.currentDocument.is_new)?n("b-form",{on:{submit:function(e){return e.preventDefault(),t.handleDocumentTypeSubmit(e)}}},[n("h3",[t._v("\n            Document |\n            "+t._s([t.currentDocument.id,t.currentDocument.title].join(" # "))+"\n          ")]),t._v(" "),n("b-form-group",{attrs:{label:"Title"}},[n("b-input",{attrs:{required:"",placeholder:"Loan Document Title"},model:{value:t.currentDocument.title,callback:function(e){t.$set(t.currentDocument,"title",e)},expression:"currentDocument.title"}})],1),t._v(" "),n("b-form-group",{attrs:{label:"Is Mandatory"}},[n("b-checkbox",{model:{value:t.currentDocument.is_mandatory,callback:function(e){t.$set(t.currentDocument,"is_mandatory",e)},expression:"currentDocument.is_mandatory"}},[t._v("\n              Is Mandatory?\n            ")])],1),t._v(" "),n("b-button",{attrs:{type:"submit",block:"",variant:"dark"}},[t._v("SUBMIT")])],1):t._e()],1)],1)],1)],1)}),[],!1,null,null,null).exports}}]);