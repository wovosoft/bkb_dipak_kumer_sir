(self.webpackChunk=self.webpackChunk||[]).push([[674],{8368:(t,e,a)=>{"use strict";a.d(e,{Z:()=>r});var i=a(3645),n=a.n(i)()((function(t){return t[1]}));n.push([t.id,"#branch_list .close.text-dark{color:#fff!important}",""]);const r=n},4674:(t,e,a)=>{"use strict";a.r(e),a.d(e,{default:()=>c});var i=a(8845),n=a(4719);const r={components:{TheTable:i.Z},mixins:[n.ZP],computed:{baseUrl:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(){return baseUrl()}))},data:function(){return{currentItem:null,divisional_offices:[],branches:[],fields:[{key:"id",sortable:!0},{key:"name",sortable:!0},{key:"divisional_office",sortable:!0,formatter:function(t){return t?t.name:null}},{key:"action",thClass:"text-right",tdClass:"text-right"}]}},mounted:function(){this.getDivisions()},methods:{o2t:n.EI,initAddForm:function(){this.$set(this,"currentItem",{name:null,address:null}),this.$bvModal.show("edit_modal")},getDivisions:function(){var t=this;axios.post(this.baseUrl+"/backend/divisional_offices/list").then((function(e){var a=e.data;t.divisional_offices=a})).catch((function(e){var a=e.response;t.divisional_offices=[],console.log(a.data)}))},getBranches:function(t){var e=this;axios.post(this.baseUrl+"/backend/branches/list",{crm_rm_office_id:t.id}).then((function(t){var a=t.data;e.branches=a})).catch((function(t){var a=t.response;e.branches=[],console.log(a.data)}))},handleSubmit:function(){var t=this;axios.post(this.baseUrl+"/backend/crm_rm_offices/store",JSON.parse(JSON.stringify(this.currentItem))).then((function(e){var a=e.data;console.log(a),t.$bvToast.toast(a.message,{title:a.title,autoHideDelay:3e3,appendToast:!0,variant:a.variant||"success"}),t.$refs.datatable.refresh(),t.$bvModal.hide("edit_modal")})).catch((function(e){var a=e.response;console.log(a.data),t.$bvToast.toast(a.data.message,{title:"Server Error",variant:"danger",autoHideDelay:3e3,appendToast:!0})}))}}};var s=a(3379),o=a.n(s),l=a(8368),d={insert:"head",singleton:!1};o()(l.Z,d);l.Z.locals;const c=(0,a(1900).Z)(r,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("the-table",{attrs:{datatable:t.datatable,fields:t.fields},scopedSlots:t._u([{key:"header_buttons",fn:function(){return[a("b-button-group",{attrs:{size:"sm"}},[a("b-button",{attrs:{variant:"dark"},on:{click:t.initAddForm}},[a("b-icon-plus")],1)],1)]},proxy:!0}])},[t._v(" "),a("b-table",t._b({ref:"datatable",attrs:{"no-provider-filtering":!1,"api-url":t.baseUrl+"/backend/crm_rm_offices"},scopedSlots:t._u([{key:"cell(action)",fn:function(e){return[a("b-button-group",{attrs:{size:"sm"}},[a("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal:view_modal",arg:"view_modal"}],attrs:{variant:"dark",title:"View"},on:{click:function(a){t.currentItem=JSON.parse(JSON.stringify(e.item))}}},[a("b-icon-eye")],1),t._v(" "),a("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal:edit_modal",arg:"edit_modal"}],attrs:{variant:"warning",title:"Edit"},on:{click:function(a){t.currentItem=JSON.parse(JSON.stringify(e.item))}}},[a("b-icon-pencil-square")],1),t._v(" "),a("b-button",{attrs:{variant:"danger",title:"Delete"}},[a("b-icon-trash")],1),t._v(" "),a("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle:branch_list",arg:"branch_list"}],attrs:{variant:"dark",title:"Branch List"},on:{click:function(a){return t.getBranches(e.item)}}},[a("b-icon-list")],1)],1)]}}])},"b-table",Object.assign({},t.attrs),!1))],1),t._v(" "),a("b-modal",t._b({attrs:{lazy:"",id:"edit_modal"},on:{hidden:function(e){t.currentItem=null}}},"b-modal",{size:"md",bodyClass:"p-2",headerBgVariant:"dark",headerTextVariant:"light",title:"Add/Edit CRM-RM Office",hideFooter:!0},!1),[t.currentItem?a("b-form",{on:{submit:function(e){return e.preventDefault(),t.handleSubmit(e)}}},[a("b-form-group",{attrs:{label:"Divisional Office *"}},[a("b-select",{attrs:{required:!0,"text-field":"name","value-field":"id",options:t.divisional_offices},model:{value:t.currentItem.divisional_office_id,callback:function(e){t.$set(t.currentItem,"divisional_office_id",e)},expression:"currentItem.divisional_office_id"}})],1),t._v(" "),a("b-form-group",{attrs:{label:"Name *"}},[a("b-input",{attrs:{required:!0,placeholder:"Name"},model:{value:t.currentItem.name,callback:function(e){t.$set(t.currentItem,"name",e)},expression:"currentItem.name"}})],1),t._v(" "),a("b-button",{attrs:{type:"submit",variant:"dark",block:""}},[t._v("SUBMIT")])],1):t._e()],1),t._v(" "),a("b-modal",t._b({attrs:{lazy:"",id:"view_modal"},on:{hidden:function(e){t.currentItem=null}}},"b-modal",{bodyClass:"p-2",headerBgVariant:"dark",headerTextVariant:"light",title:"View Details"},!1),[t.currentItem?a("b-table",{attrs:{"thead-class":"d-none",bordered:"",hover:"",striped:"",small:"","head-variant":"dark",items:t.o2t(t.currentItem,["divisional_office_id"])},scopedSlots:t._u([{key:"cell(key)",fn:function(e){return[t._v("\n                "+t._s(t._f("startCase")(e.item.key))+"\n            ")]}},{key:"cell(value)",fn:function(e){return[["created_at","updated_at"].includes(e.item.key)?[t._v("\n                    "+t._s(t._f("dayjs")(e.item.value))+"\n                ")]:[t._v("\n                    "+t._s(e.item.value)+"\n                ")]]}}],null,!1,4228248442)}):t._e()],1),t._v(" "),a("b-sidebar",{attrs:{id:"branch_list",title:"Branch List",right:"","sidebar-class":"sidebar-mw-50","body-class":"overflow-hidden",shadow:"","header-class":"bg-primary text-light",backdrop:""},on:{hidden:function(e){t.branches=[]}}},[a("b-table-lite",{attrs:{hover:"",striped:"",small:"","sticky-header":"calc(100vh - 50px)","head-variant":"dark",fields:["id",{key:"branch_name",label:"Name"},{key:"branch_code",label:"Code"},"routing_no","address","city","zip"],items:t.branches}})],1)],1)}),[],!1,null,null,null).exports}}]);